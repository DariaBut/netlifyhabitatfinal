{"version":3,"file":"pipeline.js","sourceRoot":"","sources":["../../src/pipeline.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAKa,QAAA,YAAY,GAAG,UACxB,YAA0C,EAC1C,eAA6C,EAC7C,gBAA8C;IAF9C,6BAAA,EAAA,iBAA0C;IAC1C,gCAAA,EAAA,oBAA6C;IAC7C,iCAAA,EAAA,qBAA8C;IAE9C,OAAO;QACH,UAAU,EAAE,UAAC,KAA8B;YACvC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;gBACf,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;QACP,CAAC;QACD,OAAO,EAAE,UAAC,KAA8B;YACpC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;gBACf,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC5B,CAAC,CAAC,CAAC;QACP,CAAC;QACD,WAAW,EAAE,UAAC,KAA8B;YACxC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;gBACf,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,CAAC,CAAC,CAAC;QACP,CAAC;QACD,GAAG,EAAE,UAAC,OAAgB;YAClB,OAAA,SAAI,eAAe,EAAK,YAAY,EAAK,gBAAgB,EAAE,MAAM,CAC7D,UAAC,MAAM,EAAE,IAAI,IAAK,OAAA,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAArB,CAAqB,EACvC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAC3B;QAHD,CAGC;KACR,CAAC;AACN,CAAC,CAAC","sourcesContent":["export interface PipelineStep<Context> {\r\n    name: string;\r\n    run: (context: Context) => Promise<Context>;\r\n}\r\n\r\nexport const makePipeline = <Context>(\r\n    processSteps: PipelineStep<Context>[] = [],\r\n    preProcessSteps: PipelineStep<Context>[] = [],\r\n    postProcessSteps: PipelineStep<Context>[] = []\r\n) => {\r\n    return {\r\n        addPreStep: (steps: PipelineStep<Context>[]) => {\r\n            steps.forEach((step) => {\r\n                preProcessSteps.push(step);\r\n            });\r\n        },\r\n        addStep: (steps: PipelineStep<Context>[]) => {\r\n            steps.forEach((step) => {\r\n                processSteps.push(step);\r\n            });\r\n        },\r\n        addPostStep: (steps: PipelineStep<Context>[]) => {\r\n            steps.forEach((step) => {\r\n                postProcessSteps.push(step);\r\n            });\r\n        },\r\n        run: (context: Context) =>\r\n            [...preProcessSteps, ...processSteps, ...postProcessSteps].reduce(\r\n                (result, step) => result.then(step.run),\r\n                Promise.resolve(context)\r\n            ),\r\n    };\r\n};\r\n"]}